import { useEffect, useState } from 'react';
import Head from 'next/head';

export default function Home() {
  const [isDarkMode, setIsDarkMode] = useState(false);
  
  useEffect(() => {
    // Typing animation functionality
    const texts = [
      "Get Help With Class Scheduling",
      "Get Help With Professors",
      "Get Help With Counseling"
    ];
    let currentIndex = 0;
    let isDeleting = false;
    let currentText = '';
    let typingSpeed = 50;
    const deletingSpeed = 30;
    const pauseTime = 1500;

    const typingElement = document.querySelector('.typing-text');
    if (!typingElement) return;

    function type() {
      const fullText = texts[currentIndex];
      
      if (isDeleting) {
        currentText = fullText.substring(0, currentText.length - 1);
      } else {
        currentText = fullText.substring(0, currentText.length + 1);
      }

      typingElement.textContent = currentText;

      if (!isDeleting && currentText === fullText) {
        isDeleting = true;
        setTimeout(type, pauseTime);
        return;
      }

      if (isDeleting && currentText === '') {
        isDeleting = false;
        currentIndex = (currentIndex + 1) % texts.length;
        setTimeout(type, typingSpeed);
        return;
      }

      setTimeout(type, isDeleting ? deletingSpeed : typingSpeed);
    }

    setTimeout(type, typingSpeed);

    // University search functionality
    const searchInput = document.querySelector('.university-search');
    const select = document.querySelector('.university-select');
    if (searchInput && select) {
      const options = Array.from(select.options);

      searchInput.addEventListener('focus', function() {
        select.style.display = 'block';
      });

      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        
        options.forEach(option => {
          const text = option.text.toLowerCase();
          option.style.display = text.includes(searchTerm) ? '' : 'none';
        });

        select.style.display = 'block';
      });

      select.addEventListener('change', function() {
        searchInput.value = this.options[this.selectedIndex].text;
        select.style.display = 'none';
      });

      document.addEventListener('click', function(e) {
        if (!e.target.closest('.university-select-container')) {
          select.style.display = 'none';
        }
      });
    }

    // Dark mode toggle functionality
    const darkModeToggle = document.querySelector('.dark-mode-toggle');
    if (darkModeToggle) {
      darkModeToggle.addEventListener('click', function() {
        this.classList.toggle('active');
        document.body.classList.toggle('dark-mode');
        setIsDarkMode(document.body.classList.contains('dark-mode'));
      });
    }

    // Cleanup function
    return () => {
      // Remove event listeners if needed
    };
  }, []);

  return (
    <>
      <Head>
        <title>Search</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      </Head>
      <div className={`app-container ${isDarkMode ? 'dark-mode' : ''}`}>
        <div className="search-container">
          <div className="typing-text"></div>
          <div className="search-input-container">
            <input type="text" className="search-input" placeholder="Search..." autoFocus />
            <label className="upload-button">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" strokeWidth="2"/>
                <line x1="12" y1="8" x2="12" y2="16" stroke="currentColor" strokeWidth="2"/>
                <line x1="8" y1="12" x2="16" y2="12" stroke="currentColor" strokeWidth="2"/>
              </svg>
              Images
              <input type="file" accept="image/*" />
            </label>
            <div className="university-select-container">
              <input type="text" className="university-search" placeholder="Search university..." />
              <select className="university-select" size="8">
                <option value="" disabled selected>Select University</option>
                <option value="bu">Boston University</option>
                <option value="caltech">California Institute of Technology</option>
                <option value="cmu">Carnegie Mellon University</option>
                <option value="columbia">Columbia University</option>
                <option value="cornell">Cornell University</option>
                <option value="duke">Duke University</option>
                <option value="emory">Emory University</option>
                <option value="gatech">Georgia Institute of Technology</option>
                <option value="harvard">Harvard University</option>
                <option value="jhu">Johns Hopkins University</option>
                <option value="mit">Massachusetts Institute of Technology</option>
                <option value="northwestern">Northwestern University</option>
                <option value="psu">Penn State University</option>
                <option value="princeton">Princeton University</option>
                <option value="purdue">Purdue University</option>
                <option value="rice">Rice University</option>
                <option value="stanford">Stanford University</option>
                <option value="uci">University of California, Irvine</option>
                <option value="ucla">University of California, Los Angeles</option>
                <option value="ucsd">University of California, San Diego</option>
                <option value="berkeley">University of California, Berkeley</option>
                <option value="uchicago">University of Chicago</option>
                <option value="uiuc">University of Illinois Urbana–Champaign</option>
                <option value="umass">University of Massachusetts Amherst</option>
                <option value="umich">University of Michigan–Ann Arbor</option>
                <option value="umn">University of Minnesota–Twin Cities</option>
                <option value="unc">University of North Carolina at Chapel Hill</option>
                <option value="upenn">University of Pennsylvania</option>
                <option value="usc">University of Southern California</option>
                <option value="utexas">University of Texas at Austin</option>
                <option value="uva">University of Virginia</option>
                <option value="uw">University of Washington, Seattle</option>
                <option value="wisc">University of Wisconsin–Madison</option>
                <option value="wustl">Washington University in St. Louis</option>
                <option value="yale">Yale University</option>
              </select>
            </div>
            <div className="dark-mode-toggle">
              <div className="slider"></div>
            </div>
          </div>
        </div>
      </div>
    </>
  );
}